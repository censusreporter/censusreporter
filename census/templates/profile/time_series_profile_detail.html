{% extends 'profile/_base_profile.html' %}{% load humanize madlibs %}

{% block head_title %}{% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %} - {{ block.super }}{% endblock %}
{% block head_meta_description %}Census data for {{ profile_data_current_year.geography.this.full_name }} (pop. {{ profile_data_current_year.geography.this.total_population|intcomma }}), including age, race, sex, income, poverty, marital status, education and more.{% endblock %}

{% block head_facebook_tags %}
        <meta property="og:title" content="Census profile: {% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %}" />
        <meta property="og:site_name" content="State of the Detroit Child" />
        <meta property="og:url" content="{{ request.build_absolute_uri }}" />
        <meta property="og:description" content="Census data for {{ profile_data_current_year.geography.this.full_name }} (pop. {{ profile_data_current_year.geography.this.total_population|intcomma }}), including age, race, sex, income, poverty, marital status, education and more." />
        <meta property="og:type" content="article" />
        {#}<meta property="og:image" content="" />{#}
{% endblock %}

{% block head_twitter_tags %}
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@d3detroit">
        <meta name="twitter:creator" content="@d3detroit">
        <meta name="twitter:title" content="Census profile: {% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %}">
        <meta name="twitter:description" content="Census data for {{ profile_data_current_year.geography.this.full_name }} (pop. {{ profile_data_current_year.geography.this.total_population|intcomma }}), including age, race, sex, income, poverty, marital status, education and more.">
        {#}<meta name="twitter:image" content="">{#}
{% endblock %}

{% block head_css_extra %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.2/dist/leaflet.css" />
<link rel="stylesheet" href="{{ STATIC_URL }}css/vendor/leaflet.label.css" />
<link rel="stylesheet" href="{{ STATIC_URL }}css/print.css">
{% endblock %}

{% block head_javascript_extra %}
<script src="https://unpkg.com/leaflet@0.7.2/dist/leaflet.js"></script>
<script src="{{ STATIC_URL }}js/vendor/leaflet.label.js"></script>
{% endblock %}

{% block body_id %}profile{% endblock %}

{% block header_content %}
<div id="cover-map" class="clearfix">
    <div id="slippy-map"></div>
    <div id="cover-profile" class="wrapper">
        <article class="clearfix column-half">
            <header id="header-box" class="column-full">
                <h1 class="title">{% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %}</h1>
                {% if profile_data_current_year.geography.this.sumlevel != '010' and profile_data_current_year.geography.this.sumlevel != '040' %}
                <p class="caption"></p>
                {% endif %}
            </header>
            <div class="column-half">
                <div class="stat">
                    <span class="primary">
                        <span class="value">{{ profile_data_current_year.geography.this.total_population|intcomma }}</span>
                        <span class="name">Population ({{current_year}})</span>
                    </span>
                </div>
            </div>
            {% if profile_data_current_year.geo_metadata.square_miles or profile_data_current_year.geo_metadata.population_density %}
            <div class="column-half">
                <div class="stat">
                    <span class="secondary">
                        <span class="value">{% if profile_data_current_year.geo_metadata.square_miles < .1 %}{{ profile_data_current_year.geo_metadata.square_miles|floatformat:"3" }}{% else %}{{ profile_data_current_year.geo_metadata.square_miles|floatformat|intcomma }}{% endif %}</span>
                        <span class="name"> square miles</span>
                    </span>
                    <span class="secondary">
                        <span class="value">{{ profile_data_current_year.geo_metadata.population_density|floatformat|intcomma }}</span>
                        <span class="name"> people per square mile ({{current_year}}) </span>
                    </span>
                </div>
            </div>
            {% endif %}

            {% if profile_data_current_year.geography.this.show_extra_links %}
                {% include "profile/_blocks/_header_extra_links.html" %}
            {% endif %}

            <div class="column-full">
                <p class="caption"><strong>Census data:</strong> {{ profile_data_current_year.geography.census_release }} and {{ profile_data_past_year.geography.census_release }} unless noted. For non-Census datasets, previous and current years of data collection many vary.</p>
            </div>
        </article>
    </div>
</div>
{% endblock %}

{% block content %}
<section class="clearfix" id="query-topic-picker">
    <h2>Jump to a section: </h2>
    <div class="typeahead-container">
        <select name="select_section" onchange="location = this.value;" style="width: 100%;">
            {% comment %} <option value="#">Jump to a section: </option> {% endcomment %}
            <optgroup label="Youth &amp; Family Demographics">
                <option value="#youth-population">Youth &amp; family demographics</option>
                <option value="#youth-population">Youth population, sex &amp; age</option>
                <option value="#children-age-race">Youth age, race &amp; ethnicity</option>
                <option value="#young-men">Boys &amp; young male population, age, race &amp; ethnicity</option>
                <option value="#households">Households</option>
                <option value="#families-with-children">Families with children</option>
                <option value="#marital-status">Marital status</option>
                <option value="#births">Births</option>
                <option value="#language">Language</option>
            </optgroup>
            <optgroup label="Education">
                <option value="#third-grade-ela-proficiency">Education</option>
                <option value="#third-grade-ela-proficiency">Third grade english language arts (ELA) proficiency</option>
                <option value="#eighth-grade-math-proficiency">Eighth grade math proficiency</option>
                <option value="#school-enrollment">School enrollment</option>
                <option value="#graduation-rate">High school graduation</option>
                <option value="#educational-attainment">Educational attainment</option>
                <option value="#child-care">Child care</option>
                <option value="#school-lunch">Free and reduced school lunch</option>
                <option value="#college-enrollment-readiness">College enrollment and readiness</option>
                <option value="#student-mobility-absenteeism">Student mobility and chronic absenteeism</option>
            </optgroup>
            <optgroup label="Family &amp; Economic Security">
                <option value="#income">Family &amp; economic security</option>
                <option value="#income">Income</option>
                <option value="#child-poverty">Child poverty</option>
                <option value="#poverty">Poverty</option>
                <option value="#food-assistance">Food assistance program participation</option>
                <option value="#employment">Employment</option>
                <option value="#commute">Transportation to work</option>
                <option value="#vehicle-availability">Vehicle availability</option>
            </optgroup>
            <optgroup label="Housing Section">
                <option value="#housing-occupancy">Housing</option>
                <option value="#housing-occupancy">Units &amp; occupancy</option>
                <option value="#housing-costs">Housing costs</option>
                <option value="#housing-value">Housing value</option>
                <option value="#geographical-mobility">Geographical mobility</option>
            </optgroup>
            <optgroup label="Health &amp; Safety">
                <option value="#health-insurance">Health &amp; safety</option>
                <option value="#infant-mortality">Infant mortality</option>
                <option value="#immunizations">Immunizations</option>
                <option value="#blood-lead">Elevated blood lead levels</option>
                <option value="#hospitalization">Hospital visits through Medicaid</option>
                <option value="#health-insurance">Health insurance</option>
            </optgroup>
            <optgroup label="Other Demographics">
                <option value="#place-of-birth">Other demographics</option>
                <option value="#place-of-birth">Place of birth</option>
                <option value="#veteran-status">Veteran status</option>
            </optgroup>
        </select>
    </div>
</section>
<section class="clearfix" id="query-topic-picker">
    <h2>Find data for this place</h2>
    <div class="typeahead-container">
        <input name="topic_select" id="topic-select" type="text" placeholder="Search by table or column name..." autocomplete="off">
    </div>
</section>
<p class="explain"><b>Please note</b> that the time series view is not available for all charts and datasets. Interact with charts and statistics for <span class="glossary-term" data-keyword="margin-of-error">margins of error</span> and additional information.</p>


<article id="youth-demographics" class="clearfix">
    <header class="section-contents">
        <h1>Youth &amp; Family Demographics</h1>
        <div class="summary">
          <h3>169,766 Total Children, with 49,232 under age 5</h3>
          <h3>|</h3>
          <h3>20,276 childcare capacity</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row">
            <aside>
                <h2 class="header-for-columns"><a class="permalink section" href="#youth-population" id="youth-population" title="Permalink">Youth population, sex &amp; age<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
              </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-demographics-child_pop" data-stat-type="number" data-chart-title="Number of children under 18" data-qualifier="Universe: {{ profile_data_current_year.demographics.child_pop.total.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=profile_data_current_year.demographics.child_pop.total past_stat=profile_data_past_year.demographics.child_pop.total stat_type='number' %} {% endcomment %}
            </div>
            <div class="column-three-quarters">
                <div class="column-half">
                    <div id="chart-column_timeseries-demographics-child_sex" data-chart-title="Distribution of youth by sex" data-stat-type="scaled-percentage" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.demographics.child_sex.metadata.universe }}"></div>
                </div>
                <div class="column-half">
                    <div id="chart-column_timeseries-demographics-child_age-distribution_by_category" data-stat-type="scaled-percentage" data-chart-title="Distribution of youth by age" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.demographics.child_age.distribution_by_category.metadata.universe }}"></div>
                </div>
            </div>

        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2 class="header-for-columns"><a class="permalink section" href="#children-age-race" id="children-age-race" title="Permalink">Youth age, race &amp; ethnicity<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
              </aside>
            <div class="column-full" id="chart-column_time_series_group-demographics-child_race_grouped_under_9" data-stat-type="scaled-percentage" data-chart-title="Child population by age, race and ethnicity, 0 - 9 years" data-qualifier="Universe: {{ profile_data_current_year.demographics.child_race_grouped_under_9.metadata.universe }}; Hispanic includes respondents of any race. Other categories are non-Hispanic."></div>
        </section>

        <section class="clearfix stat-row">
            <h2 class="header-for-columns"></h2>
            <aside></aside>
            <div class="column-full" id="chart-column_time_series_group-demographics-child_race_grouped_10_to_17" data-stat-type="scaled-percentage" data-chart-title="Child population by age, race and ethnicity, 10 - 17 years" data-qualifier="Universe: {{ profile_data_current_year.demographics.child_race_grouped_10_to_17.metadata.universe }}; Hispanic includes respondents of any race. Other categories are non-Hispanic."></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2 class="header-for-columns"><a class="permalink section" href="#young-men" id="young-men" title="Permalink">Boys &amp; young male population, age, race &amp; ethnicity<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
              </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-demographics-male_child_pop" data-stat-type="number" data-chart-title="Number of male children under 18" data-qualifier="Universe: {{ profile_data_current_year.demographics.male_child_pop.total.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=demographics.male_child_pop.total stat_type='number' %} {% endcomment %}
            </div>
            <div class="column-three-quarters">
                <div class="column-half">
                    <div id="chart-column_timeseries-demographics-male_child_age_total_distribution" data-chart-title="Distribution of male youth by age" data-stat-type="scaled-percentage" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.demographics.male_child_age_total_distribution.metadata.universe }}"></div>
                </div>
                <div class="column-half">
                    <div id="chart-column_timeseries-demographics-male_child_age_race_distribution" data-stat-type="scaled-percentage" data-chart-title="Distribution of male youth by race" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.demographics.male_child_age_race_distribution.metadata.universe }}; Hispanic includes respondents of any race. Other categories are non-Hispanic."></div>
                </div>
            </div>

        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#households" id="households" title="Permalink">Households<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-families-households-number_of_households" data-stat-type="number" data-chart-title="Number of Households" data-qualifier="Universe: {{ profile_data_current_year.families.households.number_of_households.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=families.households.number_of_households stat_type='count' %} {% endcomment %}
            </div>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-families-households-persons_per_household" data-stat-type="number" data-chart-title="Persons per household" data-qualifier="Universe: {{ profile_data_current_year.families.households.persons_per_household.metadata.universe }}" data-precision='1'></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=families.households.persons_per_household stat_type='number' %} {% endcomment %}
            </div>
            <div class="column-half" id="chart-column_timeseries-families-households-distribution" data-stat-type="scaled-percentage" data-initial-sort="-value" data-chart-title="Population by household type" data-qualifier="Universe: {{ profile_data_current_year.families.households.distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#families-with-children" id="families-with-children" title="Permalink">Families with children<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-families-families_with_children-percent_familes_with_children" data-stat-type="scaled-percentage" data-chart-title="Percent of families with related children under 18" data-qualifier="Universe: {{ profile_data_current_year.families.families_with_children.percent_familes_with_children.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=families.families_with_children.percent_familes_with_children stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-families-households_with_children-percent_households_with_children" data-stat-type="scaled-percentage" data-chart-title="Percent of households with children under 18" data-qualifier="Universe: {{ profile_data_current_year.families.households_with_children.percent_households_with_children.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=families.households_with_children.percent_households_with_children stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-half" id="chart-column_timeseries-families-family_types-children" data-stat-type="scaled-percentage" data-initial-sort="-value" data-chart-title="Own Children Under 18 Years by Family Type" data-qualifier="Universe: {{ profile_data_current_year.families.family_types.children.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#marital-status" id="marital-status" title="Permalink">Marital status<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third" id="chart-column_timeseries-families-marital_status" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.families.marital_status.metadata.universe }}"></div>
            <div class="column-two-thirds" id="chart-column_time_series_group-families-marital_status_grouped" data-stat-type="scaled-percentage" data-chart-title="Marital status, by sex" data-qualifier="Universe: {{ profile_data_current_year.families.marital_status_grouped.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#births" id="births" title="Permalink">Births<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2></aside>
            <div class="column-quarter">
                {% comment %} <div id="chart-stat_timeseries-families-births-total" data-stat-type="number" data-chart-title="Total births" data-qualifier="Universe: {{ profile_data_current_year.families.births.total.metadata.universe }}"></div> {% endcomment %}
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.families.births.total stat_type='number' %}
            </div>
            <div class="column-three-quarters">
                <div class="column-half">
                    {% comment %} <div id="chart-column_timeseries-families-births-race_distribution" data-chart-title="Distribution of births race and ethnicity" data-stat-type="scaled-percentage" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.families.births.race_distribution.metadata.universe }}; Hispanic includes respondents of any race. Other categories are non-Hispanic."></div> {% endcomment %}
                    <div id="chart-pie-families-births-race_distribution" data-chart-title="Distribution of births race and ethnicity (2016)" data-stat-type="percentage" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.families.births.race_distribution.metadata.universe }}; Hispanic includes respondents of any race. Other categories are non-Hispanic."></div>
                </div>
                <div class="column-half">
                    {% comment %} <div id="chart-column_timeseries-families-births-by_characteristic" data-stat-type="scaled-percentage" data-chart-title="Distribution of births by select characteristic" data-qualifier="Universe: {{ profile_data_current_year.families.births.by_characteristic.metadata.universe }}"></div> {% endcomment %}
                    <div id="chart-column-families-births-by_characteristic" data-stat-type="scaled-percentage" data-chart-title="Distribution of births by select characteristic (2016)" data-qualifier="Universe: {{ profile_data_current_year.families.births.by_characteristic.metadata.universe }}"></div>
                </div>
            </div>

        </section>
        <section class="clearfix stat-row grouped-row">
            <aside></aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-families-fertility-total" data-stat-type="scaled-percentage" data-chart-title="Women 15-50 who gave birth during past year" data-qualifier="Universe: {{ profile_data_current_year.families.fertility.total.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=families.fertility.total stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters">
                <div id="chart-column_timeseries-families-fertility-by_age" data-stat-type="scaled-percentage" data-chart-title="Women who gave birth during past year, by age group" data-qualifier="Universe: {{ profile_data_current_year.families.fertility.by_age.metadata.universe }}"></div>
            </div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#language" id="language" title="Permalink">Language<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half" id="chart-column_timeseries-social-language-children" data-stat-type="scaled-percentage" data-initial-sort="-value" data-chart-title="Language at home, children 5-17" data-qualifier="Universe: {{ profile_data_current_year.social.language.children.metadata.universe }}"></div>
            <div class="column-half" id="chart-column_timeseries-social-language-adults" data-stat-type="scaled-percentage" data-initial-sort="-value" data-chart-title="Language at home, adults 18+" data-qualifier="Universe: {{ profile_data_current_year.social.language.adults.metadata.universe }}"></div>

        </section>

    </div>
</article>



<article id="education" class="clearfix">
    <header class="section-contents">
        <h1>Education</h1>
        <div class="summary">
          <h3>169,766 children under age 18</h3>
          <h3>|</h3>
          <h3>43,760 children ages 5-9 enrolled in school</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#third-grade-ela-proficiency" id="third-grade-ela-proficiency" title="Permalink">Third grade english language arts (ELA) proficiency <i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.third_grade_ela.percent_met stat_type='percentage' %}
            </div>
            <div class="column-half" id="chart-pie-social-third_grade_ela-third_grade_ela_chart_data" data-stat-type="percentage" data-qualifier="Universe: {{ profile_data_current_year.social.third_grade_ela.third_grade_ela_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <h2><a class="permalink section" href="#eighth-grade-math-proficiency" id="eighth-grade-math-proficiency" title="Permalink">Eighth grade math proficiency<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            <aside>
            </aside>
            <div class="column-half">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.eighth_grade_math.percent_met stat_type='percentage' %}
            </div>
            <div class="column-half" id="chart-pie-social-eighth_grade_math-eighth_grade_math_chart_data" data-stat-type="percentage" data-qualifier="Universe: {{ profile_data_current_year.social.eighth_grade_math.eighth_grade_math_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#school-enrollment" id="school-enrollment" title="Permalink">School enrollment<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half">
                <div class="column-half">
                    <div id="chart-stat_timeseries-social-enrollment-enrolled" data-stat-type="number" data-chart-title="Number of children 5 to 9 years enrolled in school" data-qualifier="Universe: {{ profile_data_current_year.social.enrollment.enrolled.metadata.universe }}"></div>
                    {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.enrollment.enrolled stat_type='number' %} {% endcomment %}
                </div>
                <div class="column-half">
                    <div id="chart-stat_timeseries-social-enrollment-not_enrolled" data-stat-type="number" data-chart-title="Number of children 5 to 9 years not enrolled in school" data-qualifier="Universe: {{ profile_data_current_year.social.enrollment.not_enrolled.metadata.universe }}"></div>
                    {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.enrollment.not_enrolled stat_type='number' %} {% endcomment %}
                </div>
            </div>
            <div class="column-half" id="chart-column_time_series_group-social-enrollment-youth_school_enrollment_grouped" data-stat-type="scaled-percentage" data-chart-title="School enrollment for 5 to 9 year olds by school type and sex" data-qualifier="Universe: {{ profile_data_current_year.social.enrollment.youth_school_enrollment_grouped.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#graduation-rate" id="graduation-rate" title="Permalink">High school graduation<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half">
                {% comment %} <div id="chart-stat_timeseries-social-graduation-graduation_rate" data-stat-type="scaled-percentage" data-chart-title="Graduation Rate" data-qualifier="Universe: {{ profile_data_current_year.social.graduation.graduation_rate.metadata.universe }}"></div> {% endcomment %}
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.graduation.graduation_rate stat_type='percentage' %}
            </div>
            {% comment %} <div class="column-two-thirds" id="chart-column_timeseries-social-graduation_chart_data" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.graduation_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-half" id="chart-pie-social-graduation_chart_data" data-stat-type="percentage" data-qualifier="Universe: {{ profile_data_current_year.social.graduation_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#educational-attainment" id="educational-attainment" title="Permalink">Educational attainment<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half">
                <div class="column-half">
                    <div id="chart-stat_timeseries-social-educational_attainment-percent_high_school_grad_or_higher" data-stat-type="scaled-percentage" data-chart-title="High school grad or higher" data-qualifier="Universe: {{ profile_data_current_year.social.educational_attainment.percent_high_school_grad_or_higher.metadata.universe }}"></div>
                    {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.educational_attainment.percent_high_school_grad_or_higher stat_type='percentage' %} {% endcomment %}
                </div>
                <div class="column-half">
                    <div id="chart-stat_timeseries-social-educational_attainment-percent_bachelor_degree_or_higher" data-stat-type="scaled-percentage" data-chart-title="Bachelor's degree or higher" data-qualifier="Universe: {{ profile_data_current_year.social.educational_attainment.percent_bachelor_degree_or_higher.metadata.universe }}"></div>
                    {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.educational_attainment.percent_bachelor_degree_or_higher stat_type='percentage' %} {% endcomment %}
                </div>
            </div>
            <div class="column-half" id="chart-column_timeseries-social-educational_attainment_distribution" data-stat-type="scaled-percentage" data-chart-title="Population by minimum level of education" data-qualifier="Universe: {{ profile_data_current_year.social.educational_attainment_distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#child-care" id="child-care" title="Permalink">Child care<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
              </aside>
            <div class="column-third">
                {% comment %} <div id="chart-stat_timeseries-families-child_care-child_care_centers" data-stat-type="scaled-percentage" data-chart-title="Number of licensed child care facilities" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_centers.metadata.universe }}"></div> {% endcomment %}
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.families.child_care.child_care_centers stat_type='count' %}
            </div>
            <div class="column-third">
                {% comment %} <div id="chart-column_timeseries-families-child_care-child_care_center_chart_data" data-stat-type="scaled-percentage" data-chart-title="Licensed child care facilities by type" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_center_chart_data.metadata.universe }}"></div> {% endcomment %}
                <div id="chart-column-families-child_care-child_care_center_chart_data" data-stat-type="scaled-percentage" data-chart-title="Licensed child care facilities by type (2018)" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_center_chart_data.metadata.universe }}"></div>
            </div>
            <div class="column-third">
                {% comment %} <div id="chart-column_timeseries-families-child_care-child_care_program_chart_data" data-stat-type="scaled-percentage" data-chart-title="Free child care programs by type" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_program_chart_data.metadata.universe }}"></div> {% endcomment %}
                <div id="chart-column-families-child_care-child_care_program_chart_data" data-stat-type="scaled-percentage" data-chart-title="Free child care programs by type (2018)" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_program_chart_data.metadata.universe }}"></div>
            </div>
        </section>

        <section class="clearfix stat-row grouped-row">
            <aside></aside>
            <div class="column-third">
                {% comment %} <div id="chart-stat_timeseries-families-child_care-child_care_capacity" data-stat-type="scaled-percentage" data-chart-title="Total capacity of licensed child care facilities" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_capacity.metadata.universe }}"></div> {% endcomment %}

                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.families.child_care.child_care_capacity stat_type='count' %}
            </div>
            <div class="column-two-thirds">
                {% comment %} <div id="chart-column_timeseries-families-child_care-child_care_capacity_chart_data" data-stat-type="scaled-percentage" data-chart-title="Percent of total capacity in free child care programs, by program type" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_capacity_chart_data.metadata.universe }}"></div> {% endcomment %}
                <div id="chart-column-families-child_care-child_care_capacity_chart_data" data-stat-type="scaled-percentage" data-chart-title="Percent of total capacity in free child care programs, by program type (2018)" data-qualifier="Universe: {{ profile_data_current_year.families.child_care.child_care_capacity_chart_data.metadata.universe }}"></div>
            </div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#school-lunch" id="school-lunch" title="Permalink">Free and reduced school lunch<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                {% comment %} <div id="chart-stat_timeseries-social-school_lunch-percent_free_reduced" data-stat-type="scaled-percentage" data-chart-title="Percent of total students reported eligible for free or reduced price lunches" data-qualifier="Universe: {{ profile_data_current_year.social.school_lunch.percent_free_reduced.metadata.universe }}"></div> {% endcomment %}
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.school_lunch.percent_free_reduced stat_type='percentage' %}
            </div>
            {% comment %} <div class="column-two-thirds" id="chart-column_timeseries-social-school_lunch-school_lunch_chart_data" data-chart-title="Percent of students eligible for free or reduced price lunches by status" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.school_lunch.school_lunch_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-two-thirds" id="chart-column-social-school_lunch-school_lunch_chart_data" data-chart-title="Percent of students eligible for free or reduced price lunches by status (2017)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.school_lunch.school_lunch_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#college-enrollment-readiness" id="college-enrollment-readiness" title="Permalink">College enrollment and readines<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-two-thirds">
                <div class="column-third">
                    {% comment %} <div id="chart-stat_timeseries-social-college_readiness-sat_all_subject" data-stat-type="number" data-chart-title="Average SAT score in all subjects" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.sat_all_subject.metadata.universe }}"></div> {% endcomment %}
                    {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.college_readiness.sat_all_subject stat_type='number' %}
                </div>
                <div class="column-third">
                    {% comment %} <div id="chart-stat_timeseries-social-college_readiness-sat_math" data-stat-type="number" data-chart-title="Average SAT score in math" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.sat_math.metadata.universe }}"></div> {% endcomment %}
                    {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.college_readiness.sat_math stat_type='number' %}
                </div>
                <div class="column-third">
                    {% comment %} <div id="chart-stat_timeseries-social-college_readiness-sat_reading_writing" data-stat-type="number" data-chart-title="Average SAT score in evidenced-based reading and writing" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.sat_reading_writing.metadata.universe }}"></div> {% endcomment %}
                    {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.college_readiness.sat_reading_writing stat_type='number' %}
                </div>
            </div>
            {% comment %} <div class="column-third">
                <div id="chart-stat_timeseries-social-college_enrollment-percent_enrolled" data-stat-type="scaled-percentage" data-chart-title="Percent of public high school graduates who have enrolled in college within 12 months of graduation" data-qualifier="Universe: {{ profile_data_current_year.social.college_enrollment.percent_enrolled.metadata.universe }}"></div>

            </div> {% endcomment %}
            <div class="column-third" id="chart-pie-social-college_enrollment-college_enrollment_chart_data" data-stat-type="percentage" data-initial-sort="-value" data-chart-title="Percent of public high school graduates who have enrolled or not enrolled in college within 12 months of graduation (2018)" data-qualifier="Universe: {{ profile_data_current_year.social.college_enrollment.college_enrollment_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row grouped-row">
            <aside>
            </aside>
            {% comment %} <div class="column-third">
                <div id="chart-stat_timeseries-social-college_readiness-percent_proficient" data-stat-type="scaled-percentage" data-chart-title="Percent of students who scored at or above college readiness proficiency on the SAT assessment in all subjects" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.percent_proficient.metadata.universe }}"></div>
            </div> {% endcomment %}
            <div class="column-third" id="chart-pie-social-college_readiness-pct_college_ready_chart_data" data-stat-type="percentage" data-initial-sort="-value" data-chart-title="Percent of students who scored at, above or below college readiness proficiency on the SAT assessment in all subjects (2018)" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.pct_college_ready_chart_data.metadata.universe }}"></div>

            {% comment %} <div class="column-two-thirds" id="chart-column_timeseries-social-college_readiness-college_readiness_chart_data" data-chart-title="Percent of students who scored at or above college readiness proficiency on the SAT test by subject" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.college_readiness_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-two-thirds" id="chart-column-social-college_readiness-college_readiness_chart_data" data-chart-title="Percent of students who scored at or above college readiness proficiency on the SAT test by subject (2018)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.college_readiness.college_readiness_chart_data.metadata.universe }}"></div>
        </section>
        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#student-mobility-absenteeism" id="student-mobility-absenteeism" title="Permalink">Student mobility and chronic absenteeism<i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-half" id="chart-pie-social-student_mobility-student_mobility_chart_data" data-stat-type="percentage" data-initial-sort="-value" data-chart-title="Percent of public school students either leaving or entering a new school during the school year (2018)" data-qualifier="Universe: {{ profile_data_current_year.social.student_mobility.student_mobility_chart_data.metadata.universe }}"></div>
            <div class="column-half" id="chart-pie-social-chronic_absenteeism-chronic_absenteeism_chart_data" data-stat-type="percentage" data-initial-sort="-value" data-chart-title="Percent of public school students missing 10% or more school days (2018)" data-qualifier="Universe: {{ profile_data_current_year.social.chronic_absenteeism.chronic_absenteeism_chart_data.metadata.universe }}"></div>
        </section>


    </div>
</article>


<article id="economics" class="clearfix">
    <header class="section-contents">
        <h1>Family &amp; Economic Security</h1>
        <div class="summary">
          <h3>169,766 children under age 18, with 52% living in poverty</h3>
          <h3>|</h3>
          <h3>77% of youth age 16-19 are in school</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#income" id="income" title="Permalink">Income<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-income-per_capita_income_in_the_last_12_months" data-stat-type="dollar" data-chart-title="Per capita income" data-qualifier="Universe: {{ profile_data_current_year.economics.income.per_capita_income_in_the_last_12_months.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.income.per_capita_income_in_the_last_12_months stat_type='dollar' %} {% endcomment %}
            </div>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-income-median_household_income" data-stat-type="dollar" data-chart-title="Median household income" data-qualifier="Universe: {{ profile_data_current_year.economics.income.median_household_income.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.income.median_household_income stat_type='dollar' %} {% endcomment %}
            </div>
            <div class="column-half" id="chart-column_timeseries-economics-income-household_distribution" data-chart-title="Household income" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.economics.income.household_distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#child-poverty" id="child-poverty" title="Permalink">Child poverty<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-poverty-children-Below" data-stat-type="scaled-percentage" data-chart-title="Children (Under 18) below poverty line" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.children.Below.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.poverty.children.Below stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-poverty-percent_receiving_public_assistance" data-stat-type="scaled-percentage" data-chart-title="Households with children (under 18) receiving SSI, cash or food/SNAP assistance" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.percent_receiving_public_assistance.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.poverty.percent_receiving_public_assistance stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-half" id="chart-column_timeseries-economics-poverty-children_distribution_by_age" data-chart-title="Children living below the poverty line by age" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.children_distribution_by_age.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#poverty" id="poverty" title="Permalink">Poverty<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-poverty-percent_below_poverty_line" data-stat-type="scaled-percentage" data-chart-title="Persons below poverty line" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.percent_below_poverty_line.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.poverty.percent_below_poverty_line stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters" id="chart-column_time_series_group-economics-poverty-poverty_family_educational_attainment" data-stat-type="scaled-percentage" data-chart-title="Family poverty rate by educational attainment of householder" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.poverty_family_educational_attainment.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#food-assistance" id="food-assistance" title="Permalink">Food assistance program participation <i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-poverty-percent_receiving_food_assistance" data-stat-type="scaled-percentage" data-chart-title="Households with food/SNAP assistance in the past 12 months" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.percent_receiving_food_assistance.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.poverty.percent_receiving_food_assistance stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters" id="chart-column_time_series_group-economics-poverty-food_assistance_household_type" data-stat-type="scaled-percentage" data-chart-title="Household food/SNAP assistance participation in the past 12 months by household type" data-qualifier="Universe: {{ profile_data_current_year.economics.poverty.food_assistance_household_type.metadata.universe }}"></div>
        </section>


        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#employment" id="employment" title="Permalink">Employment<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-economics-employment-unemployment_rate" data-stat-type="scaled-percentage" data-chart-title="Unemployment rate" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.unemployment_rate.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.employment.unemployment_rate stat_type='percentage' %} {% endcomment %}
            </div>
            {% comment %} <div class="column-quarter">
                {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.employment.nowork_rate stat_type='percentage' %}
            </div> {% endcomment %}
            <div class="column-three-quarters" id="chart-column_time_series_group-economics-employment-youth_school_employment_grouped" data-stat-type="scaled-percentage" data-chart-title="School enrollment and labor force (LF) participation for 16 - 19 year olds by sex" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.youth_school_employment_grouped.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#commute" id="commute" title="Permalink">Transportation to work<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-economics-employment-mean_travel_time" data-stat-type="number" data-chart-title="Mean travel time to work (in minutes)" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.mean_travel_time.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.employment.mean_travel_time stat_type='time' stat_suffix='minutes' %} {% endcomment %}
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-economics-employment-transportation_distribution" data-chart-title="Means of transportation to work" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.transportation_distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#vehicle-availability" id="vehicle-availability" title="Permalink">Vehicle availabilty<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-economics-employment-mean_number_of_vehicles" data-stat-type="number" data-precision='1' data-chart-title="Average number of vehicles available" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.mean_number_of_vehicles.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=economics.employment.mean_number_of_vehicles stat_type='number' stat_suffix='vehicles' %} {% endcomment %}
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-economics-employment-distribution_vehicle_availabilty" data-chart-title="Distribution of vehicles available to workers, 16 years and over" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.economics.employment.distribution_vehicle_availabilty.metadata.universe }}"></div>
        </section>

    </div>
</article>


<article id="housing" class="clearfix">
    <header class="section-contents">
        <h1>Housing</h1>
        <div class="summary">
          <h3>$722 median monthly housing cost</h3>
          <h3>|</h3>
          <h3>53% Renter occupied</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#housing-occupancy" id="housing-occupancy" title="Permalink">Units &amp; occupancy<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-housing-units-number" data-stat-type="number" data-chart-title="Number of housing units" data-qualifier="Universe: {{ profile_data_current_year.housing.units.number.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=housing.units.number stat_type='count' %} {% endcomment %}
            </div>
            <div class="column-third" id="chart-column_timeseries-housing-units-occupancy_distribution" data-stat-type="scaled-percentage" data-chart-title="Occupied vs. Vacant" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.housing.units.occupancy_distribution.metadata.universe }}"></div>
            <div class="column-third" id="chart-column_timeseries-housing-ownership-distribution" data-stat-type="scaled-percentage" data-chart-title="Ownership of occupied units" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.housing.ownership.distribution.metadata.universe }}"></div>
        </section>
        <section class="clearfix stat-row grouped-row alt">
            <aside>
            </aside>
            <div class="column-third" id="chart-column_timeseries-housing-units-structure_distribution" data-stat-type="scaled-percentage" data-chart-title="Types of structure" data-initial-sort="-value" data-qualifier="Universe: {{ profile_data_current_year.housing.units.structure_distribution.metadata.universe }}"></div>
            <div class="column-two-thirds" id="chart-column_timeseries-housing-length_of_tenure" data-stat-type="scaled-percentage" data-chart-title="Year moved in, by percentage of population" data-qualifier="Universe: {{ profile_data_current_year.housing.length_of_tenure.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#housing-costs" id="housing-costs" title="Permalink">Housing costs<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-housing-costs-median_costs" data-stat-type="dollar" data-chart-title="Median monthly housing costs" data-qualifier="Universe: {{ profile_data_current_year.housing.units.number.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=housing.costs.median_costs stat_type='dollar' %} {% endcomment %}
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-housing-costs-housing_costs_distribution" data-chart-title="Percent of households spending 30% or more of household income on housing by household income" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.housing.costs.housing_costs_distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#housing-value" id="housing-value" title="Permalink">Housing value<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-housing-ownership-median_value" data-stat-type="dollar" data-chart-title="Median value of owner-occupied housing units" data-qualifier="Universe: {{ profile_data_current_year.housing.ownership.median_value.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=housing.ownership.median_value stat_type='dollar' %} {% endcomment %}
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-housing-ownership-value_distribution" data-chart-title="Value of owner-occupied housing units" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.housing.ownership.value_distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#geographical-mobility" id="geographical-mobility" title="Permalink">Geographical mobility<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-third">
                <div id="chart-stat_timeseries-housing-migration-moved_since_previous_year" data-stat-type="scaled-percentage" data-chart-title="Moved since previous year" data-qualifier="Universe: {{ profile_data_current_year.housing.migration.moved_since_previous_year.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=housing.migration.moved_since_previous_year stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-housing-migration_distribution" data-stat-type="scaled-percentage" data-chart-title="Population migration since previous year" data-qualifier="Universe: {{ profile_data_current_year.housing.migration_distribution.metadata.universe }}"></div>
        </section>

    </div>
</article>


<article id="social" class="clearfix">
    <header class="section-contents">
        <h1>Health &amp; safety</h1>
        <div class="summary">
          <h3>11% Under 6 years of age have elevated blood lead levels</h3>
          <h3>|</h3>
          <h3>14% of under 18 hospital visits were asthma related</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#infant-mortality" id="infant-mortality" title="Permalink">Infant mortality<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            {% comment %} <div class="column-third">
                <div id="chart-stat_timeseries-social-infant_mortality-infant_mortality" data-stat-type="number" data-chart-title="Number of infant deaths" data-qualifier="Universe: {{ profile_data_current_year.social.infant_mortality.infant_mortality.metadata.universe }}"></div>
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-social-infant_mortality_chart_data" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.infant_mortality_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-half">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.infant_mortality.infant_mortality stat_type='count' %}
            </div>
            <div class="column-half" id="chart-pie-social-infant_mortality_chart_data" data-stat-type="percentage" data-qualifier="Universe: {{ profile_data_current_year.social.infant_mortality_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#immunizations" id="immunizations" title="Permalink">Immunizations<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            {% comment %} <div class="column-third">
                <div id="chart-stat_timeseries-social-immunization-immunization" data-stat-type="number" data-chart-title="Number of infant deaths" data-qualifier="Universe: {{ profile_data_current_year.social.immunization.immunization.metadata.universe }}"></div>
            </div>
            <div class="column-two-thirds" id="chart-column_timeseries-social-immunization-immunization_chart_data" data-chart-title="Immunized children aged 19-35 months by status" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.immunization.immunization_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-half">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.immunization.immunization stat_type='count' %}
            </div>
            <div class="column-half" id="chart-column-social-immunization-immunization_chart_data" data-chart-title="Immunized children aged 19-35 months by status (2015)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.immunization.immunization_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#blood-lead" id="blood-lead" title="Permalink">Elevated blood lead levels<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            {% comment %} <div class="column-half">
                <div id="chart-stat_timeseries-social-blood_lead-percent_elevated" data-stat-type="scaled-percentage" data-chart-title="Number of infant deaths" data-qualifier="Universe: {{ profile_data_current_year.social.blood_lead.percent_elevated.metadata.universe }}"></div>
            </div>
            <div class="column-half" id="chart-column_timeseries-social-blood_lead-blood_lead_chart_data" data-chart-title="Percent of individuals tested with an elevated blood lead level (defined as > 4.5 micrograms per deciliter), by age" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.blood_lead.blood_lead_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-half">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.blood_lead.percent_elevated stat_type='percentage' %}
            </div>
            <div class="column-half" id="chart-column-social-blood_lead-blood_lead_chart_data" data-chart-title="Percent of individuals tested with an elevated blood lead level, defined as > 4.5 micrograms per deciliter, by age (2018)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.blood_lead.blood_lead_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#hospitalization" id="hospitalization" title="Permalink">Hospital visits through Medicaid<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            {% comment %} <div class="column-third">
                <div id="chart-stat_timeseries-social-medicaid-child_er" data-stat-type="scaled-percentage" data-chart-title="Number of infant deaths" data-qualifier="Universe: {{ profile_data_current_year.social.medicaid.child_er.metadata.universe }}"></div>
            </div>
            <div class="column-third" id="chart-column_timeseries-social-medicaid-er_chart_data" data-chart-title="Percent of hospital visits that were to an emergency room, by age" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.medicaid.er_chart_data.metadata.universe }}"></div>
            <div class="column-third" id="chart-column_timeseries-social-medicaid-condition_chart_data" data-chart-title="Percent of hospital visits that were to an emergency room, by condition" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.medicaid.condition_chart_data.metadata.universe }}"></div> {% endcomment %}
            <div class="column-third">
                {% include 'profile/_blocks/_stat_list.html' with stat=profile_data_current_year.social.medicaid.child_er stat_type='percentage' %}
            </div>
            <div class="column-third" id="chart-column-social-medicaid-er_chart_data" data-chart-title="Percent of hospital visits that were to an emergency room, by age (2017)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ social.medicaid.er_chart_data.metadata.universe }}"></div>
            <div class="column-third" id="chart-column-social-medicaid-condition_chart_data" data-chart-title="Percent of hospital visits that were to an emergency room, by condition (2017)" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ social.medicaid.condition_chart_data.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#health-insurance" id="health-insurance" title="Permalink">Health insurance<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-social-health_insurance-uninsured" data-stat-type="scaled-percentage" data-chart-title="Persons without health insurance" data-qualifier="Universe: {{ profile_data_current_year.social.health_insurance.uninsured.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.health_insurance.uninsured stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters" id="chart-column_time_series_group-social-health_insurance-coverage_distribution" data-stat-type="scaled-percentage" data-chart-title="Percent uninsured by age group" data-qualifier="Universe: {{ profile_data_current_year.social.health_insurance.coverage_distribution.metadata.universe }}"></div>
        </section>

    </div>

</article>

<article id="social" class="clearfix">
    <header class="section-contents">
        <h1>Other Demographics</h1>
        <div class="summary">
          <h3>84% of children ages 5-7 speak English only at home</h3>
          <h3>|</h3>
          <h3>6.1% of population is foreign-born</h3>
        </div>
    </header>
    <div class="section-container">

        <section class="clearfix stat-row">
            <aside>
                <h2><a class="permalink section" href="#place-of-birth" id="place-of-birth" title="Permalink">Place of birth<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
              </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-social-place_of_birth-percent_foreign_born" data-stat-type="scaled-percentage" data-chart-title="Foreign-born population" data-qualifier="Universe: {{ profile_data_current_year.social.place_of_birth.percent_foreign_born.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.place_of_birth.percent_foreign_born stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters" id="chart-column_timeseries-social-place_of_birth-distribution" data-chart-title="Place of birth for foreign-born population" data-stat-type="scaled-percentage" data-qualifier="Universe: {{ profile_data_current_year.social.place_of_birth.distribution.metadata.universe }}"></div>
        </section>

        <section class="clearfix stat-row alt">
            <aside>
                <h2><a class="permalink section" href="#veteran-status" id="veteran-status" title="Permalink">Veteran status<br /><i class="fa fa-link"></i></a> <a class="permalink" href="#" title="Back to top"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a></h2>
            </aside>
            <div class="column-quarter">
                <div id="chart-stat_timeseries-social-veterans-percentage" data-stat-type="scaled-percentage" data-chart-title="Population with veteran status" data-precision='1' data-qualifier="Universe: {{ profile_data_current_year.social.veterans.percentage.metadata.universe }}"></div>
                {% comment %} {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.veterans.percentage stat_type='percentage' %} {% endcomment %}
            </div>
            <div class="column-three-quarters" id="chart-stat_timeseries-social-veterans-wartime_service" data-stat-type="number" data-chart-title="Veterans by wartime service" data-qualifier="Universe: {{ profile_data_current_year.social.veterans.wartime_service.metadata.universe }}; Civilian veterans who served during wartime only"></div>
            {% comment %} <div class="column-quarter">
                <a class="stat number">
                    {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.veterans.number stat_type='number' stat_class='secondary' stat_wrapper="false" %}
                    {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.veterans.sex.male stat_type='number' stat_class='secondary' stat_wrapper="false" %}
                    {% include 'profile/_blocks/_time_series_stat_list.html' with current_stat=social.veterans.sex.female stat_type='number' stat_class='secondary' stat_wrapper="false" %}
                </a>
            </div> {% endcomment %}
        </section>
    </div>

</article>

{% endblock %}

{% block sticky_buttons %}
<!-- Add sticky buttons for time series vers one year views -->
<div class="sticky-time-series-buttons">
    <a id="one-year" class='action-button' href="#">One year</a>
    <a id="over-time" class='action-button active' href="#">Over time</a>
</div>
{% endblock %}

{% block body_javascript_extra %}{{ block.super }}
<script src="{{ STATIC_URL }}js/charts.js"></script>
<!--[if gt IE 9]><!-->
<script src="{{ STATIC_URL }}js/cr-leaflet.js"></script>
<!--<![endif]-->
<script type="text/javascript">
// Allow Ajax POST requests to bypass Django's CSRF check
// https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#ajax
var csrftoken = '{{ csrf_token }}';
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});

// Make the header map
var map;
d3.json(CR_API_URL + '/1.0/geo/tiger2019/{{ profile_data_current_year.geography.this.full_geoid }}?geom=true', function(error, json) {
    if (error) return console.warn(error);
    var allowMapDrag = (browserWidth > 480) ? true : false;

    // draw a geom
    map = L.map('slippy-map', {
        scrollWheelZoom: false,
        zoomControl: false,
        doubleClickZoom: false,
        boxZoom: false,
        keyboard: false,
        dragging: allowMapDrag,
        touchZoom: allowMapDrag
    });

    // set a tile layer
    var tiles = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png', { attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\">CC BY 3.0</a>. Data by <a href=\"http://www.openstreetmap.org/\" target=\"_blank\">OpenStreetMap</a>, under ODbL.'
    });

    // add these tiles to our map
    map.addLayer(tiles);

    if (allowMapDrag) {
        map.addControl(new L.Control.Zoom({
            position: 'topright'
        }));
    }

    if (CensusReporter.SummaryLevelLayer && thisSumlev !== "010") {
        var defaultStyle = {
                "clickable": true,
                "color": "#76AFF2",
                "fillColor": "#f1f1f2",
                "weight": 1,
                "opacity": 0.5,
                "fillOpacity": 0.3,
            },
        geojsonTileLayer = new CensusReporter.SummaryLevelLayer(thisSumlev, {},
            {
            style: defaultStyle,
            onEachFeature: function(feature, layer) {
                if (feature.properties.geoid == thisGeoID)
                    return;

                // filter out non-Michingan results
                if (feature.properties.name.search(', MI') != -1 || feature.properties.geoid.search('86000US48') != -1 || feature.properties.geoid.search('86000US49') != -1) {
                    layer.bindLabel(feature.properties.name, {direction: 'auto'});
                    layer.on('mouseover', function() {
                        layer.setStyle({
                            "weight": 2,
                            "fillOpacity": 0.4,
                            "fillColor": "#76AFF2",
                        });
                    });
                    layer.on('mouseout', function() {
                        layer.setStyle(defaultStyle);
                    });
                    layer.on('click', function() {
                        // add spinner to page load
                        var spinnerTarget = document.getElementById("body-spinner");
                        if (!spinnerTarget) {
                            $('body').append('<div id="body-spinner"></div>');
                            spinnerTarget = document.getElementById('body-spinner');
                        }
                        spinner.spin(spinnerTarget);
                        window.location.href = '/profiles/' + feature.properties.geoid + '-' + slugify(feature.properties.name);
                    });
                } else {
                    var invisibleStyle = {
                        "clickable": false,
                        "color": "#fff",
                        "fillColor": "#fff",
                        "weight": 0,
                        "opacity": 0,
                        "fillOpacity": 0,
                    }
                    layer.setStyle(invisibleStyle);
                }

            }
        });
        map.addLayer(geojsonTileLayer);
    }

    var featureLayer = L.geoJson(json, {
        style: {
            "fillColor": "#A975D7",
            "fillOpacity": 0.5,
            "color": "#686867",
            "weight": 2,
            "clickable": false
        }
    });
    map.addLayer(featureLayer);
    var objBounds = featureLayer.getBounds();

    if (thisSumlev === "010") {
        objBounds = L.latLngBounds(L.latLng(24.396, -124.849), L.latLng(49.384, -66.885));
    }

    if (browserWidth > 768) {
        var z;
        for(z = 16; z > 2; z--) {
            var swPix = map.project(objBounds.getSouthWest(), z),
                nePix = map.project(objBounds.getNorthEast(), z),
                pixWidth = Math.abs(nePix.x - swPix.x),
                pixHeight = Math.abs(nePix.y - swPix.y);
            if (pixWidth <  500 && pixHeight < 400) {
                break;
            }
        }

        map.setView(objBounds.getCenter(), z);
        map.panBy([-270, 0], {animate: false});
    } else {
        map.fitBounds(objBounds);
    }
})

// Create all the charts
var Charts = {},
    chartContainers = $('[id^=chart-]'),
    defaultDataRelease = '{{ profile_data_current_year.geography.census_release }}',
    releases = [defaultDataRelease],
    profileData = {{ profile_data_json_current_year }},
    profileDataPastYear = {{ profile_data_json_past_year }},
    years = [];
    years[0] = '{{ past_year }}';
    years[1] = '{{ current_year }}',
    latestWorkingRelease = 'acs2019_5yr';

// TO DO: Update to include time series charts
var gracefulType = function(chartType) {
    // convert certain chart types to more readable versions at narrow widths
    if (browserWidth <= 640) {
        if (chartType == 'column' || chartType == 'histogram') {
            return 'bar'
        } else if (chartType == 'grouped_column') {
            return 'grouped_bar'
        }
    }
    return chartType
}


var makeCharts = function() {

    $.each(chartContainers, function(i, obj) {
        console.log(profileDataPastYear);
        console.log($(this).prop('id'));
        $(obj).empty();
        var chartID = $(this).prop('id'),
            chartDataKey = chartID.replace('chart-','').replace('alt-',''),
            chartDataID = chartDataKey.split('-'),
            chartType = gracefulType(chartDataID[0]),
            chartData = profileData[chartDataID[1]],
            chartDataPastYear = profileDataPastYear[chartDataID[1]],
            chartChartTitle = $(this).data('chart-title'),
            chartChartShowYAxis = $(this).data('chart-show-y-axis'),
            chartInitialSort = $(this).data('initial-sort'),
            chartStatType = $(this).data('stat-type'),
            chartQualifier = $(this).data('qualifier') || null,
            chartPrecision = $(this).data('precision'),
            chartLabel = $(this).data('label'),
            geographyData = profileData['geography'],
            chartColorScale = '',
            chartRelease = latestWorkingRelease;


        // toggle color scale if new section
        if ($(this).parents('.alt').length > 0) {
            chartColorScale = "Kat2Alt";
        } else {
            chartColorScale = "Kat2";
        }

        // allow arbitrary nesting in API data structure
        var drilldown = chartDataID.length - 1;
        if (drilldown >= 2) {
            for (var n = 2; n <= drilldown; n++) {
                chartData = chartData[chartDataID[n]];
                if (chartDataID[n] in chartDataPastYear) {
                    chartDataPastYear = chartDataPastYear[chartDataID[n]];
                }
            }
        }

        // determine whether data point is from anything other
        // than the primary ACS release for this page
        for (var key in chartData) if (chartData.hasOwnProperty(key)) break;
        let acs_release;
        for (var k in chartData) {
            if (k == 'metadata') {
                acs_release = chartData[k]['acs_release']
            } else if (k == 'total') {
                acs_release = chartData[k]['metadata']['acs_release']
            }
        }

        if (acs_release && acs_release == 'ACS 2018 5-year') {
            var thisRelease = "ACS 2013 and 2018 5-year";
        } else if (acs_release) {
            var thisRelease = acs_release;
            chartRelease = 'd3_present';
        } else {
            var thisRelease = '';
        }
        var noteRelease = (thisRelease != defaultDataRelease) ? thisRelease + ' data' : null;

        chartQualifier = Array(chartQualifier, noteRelease)
                .filter(function(n) { return n }).join('; ');

        var chartstuff = {
            chartContainer: chartID,
            chartDataKey: chartDataKey,
            chartType: chartType,
            chartHeight: 160,
            chartData: chartData,
            chartDataPastYear: chartDataPastYear,
            chartQualifier: chartQualifier,
            chartChartTitle: chartChartTitle,
            chartInitialSort: chartInitialSort,
            chartStatType: chartStatType,
            chartPrecision: chartPrecision,
            geographyData: geographyData,
            chartColorScale: chartColorScale,
            chartLabel: chartLabel,
            release: chartRelease,
        }
        try {
            Charts[i] = Chart(chartstuff);
        } catch(e) {
            console.log(e);
            console.log("Error making chart " + chartID)
            console.log(chartstuff);
        }

        // build array of releases used on this page for citations
        if (noteRelease) { releases.push(noteRelease) }
    });
}
makeCharts();

// listen for resize, redraw charts to new dimensions
var lazyRedrawCharts = _.debounce(function() {
    window.browserWidth = document.documentElement.clientWidth;
    window.browserHeight = document.documentElement.clientHeight;
    makeCharts();
}, 50);
$(window).resize(lazyRedrawCharts);

// Add note to rows with flagged MOE
var flaggedMOE = $('.stat-row sup'),
    daggerNote = '<p><sup>&dagger;</sup> Margin of error is at least 10 percent of the total value. Take care with this statistic.</p>';

flaggedMOE.closest('.stat-row').find('aside').html(daggerNote);

// Enable the single-table topic picker
var thisSumlev = '{{ profile_data_current_year.geography.this.sumlevel }}',
    thisGeoShortName = '{{ profile_data_current_year.geography.this.short_name }}',
    thisGeoID = '{{ profile_data_current_year.geography.this.full_geoid }}',
    placeGeoID = '{{ profile_data_current_year.geography.parents.place.full_geoid }}',
    CBSAGeoID = '{{ profile_data_current_year.geography.parents.CBSA.full_geoid }}',
    countyGeoID = '{{ profile_data_current_year.geography.parents.county.full_geoid }}',
    stateGeoID = '{{ profile_data_current_year.geography.parents.state.full_geoid }}',
    nationGeoID = '{{ profile_data_current_year.geography.parents.nation.full_geoid }}';

// Update the header's list of parent geographies
var parentLinkContainer = $('#header-box .caption'),
    parentLinksPrefix = '<span class="glossary-term">{{ profile_data_current_year.geography.this.sumlevel_name|capfirst }}</span> in: ',
    parentGeoAPI = CR_API_URL + '/1.0/geo/tiger2019/' + thisGeoID + '/parents',
    tilesGeoAPI = 'https://hipapi.datadrivendetroit.org/1.0/geo/tiger2019/tiles/' + thisSumlev + '/{z}/{x}/{y}.geojson';

// for touch devices, still allow context toggle
$('.stat-row').on('click', '.stat', function() {
    $(this).find('.context').toggle();
})

if (!!parentLinkContainer) {
    // set up the listener for trigger to reveal hidden groups
    $('#header-box').on('click', '.link-reveal', function() {
        $(this).hide().next('.hidden').show();
        return false;
    });

    // hit the /parents API endpoint
    $.getJSON(parentGeoAPI)
        .done(function(results) {
            // filter out 'this' from the parents
            // filter out any parents further up from state
            var parents = _.reject(results['parents'], function(p) {
                return p.relation === 'this' || p.relation === 'place' || p.relation === 'nation';
            });


            // list of unique parent sumlev types, maintaining order
            var parentRelations = _.uniq(_.pluck(parents, 'sumlevel'));
            // collect parents into individual sumlev groups
            var parentGroups = _.groupBy(parents, function(d) {
                return d.sumlevel;
            });
            // for each parent sumlev type ...
            var parentLinkSets = _.map(parentRelations, function(r) {
                // ... compile a set of links to individual profile pages
                var parentLinkSet = _.map(parentGroups[r], function(v, k) {
                    return '<a href="/profiles/' + v.geoid + '-' + slugify(v.display_name) + '/">' + v.display_name + '</a>';
                });
                var numParents = parentLinkSet.length;
                // if more than one of a sumlev type, group behind reveal link
                if (numParents > 1) {
                    return '<a href="#" class="link-reveal">'+numParents+' '+ sumlevMap[r]['plural'] +'</a><span class="hidden">'+parentLinkSet.join(', ')+'</span>';
                } else {
                    // just one of this sumlev type, so add it to list
                    return parentLinkSet;
                }
            })
            // push the whole thing into the header box ... thingy
            parentLinkContainer.html(parentLinksPrefix + parentLinkSets.join(', '));
            $('body').trigger('glossaryUpdate', parentLinkContainer);
        });
}

// add citations for each data release used for page
/*
if (releases.length > 1) {
    var explain = '<p class="explain"><em>This profile displays data from more than one ACS release. Charts not derived from ' + defaultDataRelease + ' data are noted with an *.</em></p>'
    $('.content-container').append(explain);
}
*/

// polyfill for String.prototype.startsWith
if (!String.prototype.startsWith) {
    String.prototype.startsWith = function(searchString, position){
      position = position || 0;
      return this.substr(position, searchString.length) === searchString;
  };
}

var makeCitation = function(year, release) {
	if (release.startsWith('D3 Open Data Portal')) {
		var citation = '<p class="explain"><strong>Citation:</strong> ' + release +
	    '. Retrieved from <em>State of the Detroit Child Profile page for {% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %}</em> <a href="{{ request.build_absolute_uri }}">{{ request.build_absolute_uri }}</a></p>';
	} else {
		var citation = '<p class="explain"><strong>Citation:</strong> ' +
	    'U.S. Census Bureau (<span id="cite-release-year">' + year + '</span>). ' +
	    '<em>American Community Survey <span id="cite-release">' + release + '</span> estimates.</em> ' +
	    'Retrieved from <em>State of the Detroit Child Profile page for {% firstof profile_data_current_year.geography.this.full_name profile_data_current_year.geography.this.short_name %}</em> <a href="{{ request.build_absolute_uri }}">{{ request.build_absolute_uri }}</a></p>';
	}


    $('.content-container').append(citation);
}

var acs_2018 = 0;
var acs_2013 = 0;
var d3_citation = 0;

$.each($.unique(releases), function(i, v) {

    var bits = v.split(" "),
        year = bits[1],
        release = bits[2];

    // handle exception for D3 open data portal
    // TO DO: update releases to add year for D3 content
    if ((year == 'Open' || year == 'data') && d3_citation == 0) {
    	year = '2020';
    	release = 'D3 Open Data Portal'
        makeCitation(year, release);
        d3_citation = 1;
    }

    if (acs_2018 == 0 && bits[0] == 'ACS' && year == '2018') {
        makeCitation(year, release);
        acs_2018 = 1;
    }

    if (acs_2013 == 0 && bits[0] == 'ACS' && year == '2013') {
        makeCitation(year, release);
        acs_2013 = 1;
    }


});

Glossary.init("{% url 'glossary' %}",".glossary-term");

// set up scroll listener to change the linked locaiton to one year data
$(function () {
    let currentHash = '#';
    const currentURL = window.location.href.split('time-series-profiles');
    const minusHash = currentURL[1].split('#');
    $('#one-year').attr("href", currentURL[0] + "profiles" + minusHash[0]);
    $(document).scroll(function () {
        $('.section').each(function () {
            const top = window.pageYOffset;
            const distance = top - $(this).offset().top;
            const hash = $(this).attr('href');
            if (distance < 30 && distance > -30 && currentHash != hash) {
                $('#one-year').attr("href", currentURL[0] + "profiles" + minusHash[0] + hash);
                currentHash = hash;
            }
        });
    });
});

function print_button() {
    map.panBy(new L.Point(400, 0), {animate: false});
    window.print();
    map.panBy(new L.Point(-400, 0), {animate: false});
}


</script>
<script src="{{ STATIC_URL }}js/profile.topic.picker.js"></script>
{% endblock %}
